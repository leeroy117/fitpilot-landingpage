---
import Layout from '../../layouts/Layout.astro';
import Navbar from '../../components/Navbar.astro';
import Footer from '../../components/Footer.astro';
import { useTranslations } from '../../i18n/utils';
import { MotionButton } from '../../components/MotionButton';
import { ProfessionalsCatalog } from '../../components/ProfessionalsCatalog';

const lang = Astro.currentLocale || 'es';
const t = useTranslations(lang as any);

const response = await fetch('https://693c97b4b762a4f15c40dfa2.mockapi.io/api/v1/professionals');
const data = await response.json();

const professionals = data.map((pro: any) => ({
  id: pro.id,
  name: pro.name,
  role: pro.role.toLowerCase().includes('nutritionist') ? 'nutritionist' : 'trainer',
  roleLabel: pro.role,
  specialties: pro.specialties,
  location: pro.location,
  rating: pro.rating,
  image: pro.image,
  online: pro.isOnline
}));
---

<Layout title={t('catalog.title')}>
  <Navbar />
  
  <main class="min-h-screen bg-slate-50">
    <!-- Content (Header + Grid) managed by React Component -->
    <ProfessionalsCatalog 
      client:load 
      initialProfessionals={professionals} 
      translations={{
          searchPlaceholder: t('catalog.search_placeholder'),
          filterAll: t('catalog.filter.all'),
          filterTrainers: t('catalog.filter.trainers'),
          filterNutritionists: t('catalog.filter.nutritionists'),
          cardSpecialties: t('catalog.card.specialties'),
          cardContact: t('catalog.card.contact'),
          showMore: "Prueba ajustando tus términos de búsqueda.",
          noResults: "No se encontraron profesionales"
      }}
    />

  </main>
  
  <Footer />
</Layout>
